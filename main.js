!function(){"use strict";class e{constructor(){this.imgBox=document.createElement("div"),this.figure=document.createElement("figure"),this.figcaption=document.createElement("figcaption"),this.img=document.createElement("img"),this.remover=document.createElement("img")}create(e,t,i){this.img.src=i,this.figcaption.textContent=t,this.img.classList.add("img"),this.img.dataset.id=e}render(e){e.appendChild(this.imgBox),this.imgBox.appendChild(this.figure),this.figure.appendChild(this.img),this.figure.appendChild(this.figcaption),this.figure.appendChild(this.remover),this.imgBox.classList.add("box"),this.remover.classList.add("remover"),this.remover.src="https://free-png.ru/wp-content/uploads/2022/01/free-png.ru-388.png"}}class t{static async getArray(){return(await fetch("https://image-manager-467n.onrender.com/files",{method:"GET"})).json()}static async postFile(e){await fetch("https://image-manager-467n.onrender.com/files",{method:"POST",body:e})}static async removeFile(e){await fetch(`https://image-manager-467n.onrender.com/files/${e}`,{method:"DELETE"})}}(new class{constructor(){this.container=document.querySelector(".images-container"),this.fileInput=document.querySelector(".file-input"),this.onChange=this.onChange.bind(this),this.removeElement=this.removeElement.bind(this)}init(){this.render(),this.fileInput.addEventListener("change",this.onChange),document.addEventListener("click",this.removeElement)}render(){t.getArray().then((e=>{e.files.forEach((e=>{this.addElement(e.id,e.filename,e.path)}))}))}clean(){this.container.replaceChildren()}onChange(){const e=this.fileInput.files&&this.fileInput.files[0];if(!e)return;const i=new FormData;i.append("file",e),t.postFile(i).then((()=>{this.clean(),this.render()}))}addElement(t,i,n){const s=new e;s.create(t,i,n),s.render(this.container)}removeElement(e){if(!e.target.closest(".remover"))return;const i=e.target.closest(".box").querySelector(".img"),{id:n}=i.dataset;t.removeFile(n).then((()=>{this.clean(),this.render()}))}}).init()}();